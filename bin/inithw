#!/bin/sh

if [ "$#" -eq 0 ]; then
    DestFolder=$(pwd)
else
    DestFolder=$1
fi

DestHwID=$(ls -d $DestFolder/hw* | wc -w)
DestHwID=$((DestHwID+1))

echo -n "Do you want to create hw$DestHwID in $(realpath $DestFolder)? [Y/n]: "
read Check
if [ "$Check" == "n" ]; then
    echo -n "Enter YourDesireID: "
    read DestHwID
fi

DestHwName="hw$DestHwID"
DestHwSolution="$DestFolder/$DestHwName/solution.tex"

cp -r $WDL_TOOL/template/_hw $DestFolder
mv $DestFolder/_hw $DestFolder/$DestHwName

InitializeSolution () {
    echo -n "Homework $1 is [$2]: "
    read Temp
    if [ -z "${Temp// }" ]; then
        Temp=$2
    fi
    sed -e "s/<$1>/$Temp/" $DestHwSolution > $DestHwSolution.tmp && mv $DestHwSolution.tmp $DestHwSolution
}

InitializeSolution "ID" $DestHwID
InitializeSolution "DueDate" "Feburary 24, 2016 at 17:00"
InitializeSolution "University" "NTU"
InitializeSolution "Class" "Network Administration\/System Administration"
InitializeSolution "ClassAlias" "NASA"
InitializeSolution "ClassSection" "Spring 2016"
InitializeSolution "Instructor" "HM Tsai"
InitializeSolution "AuthorName" "Tim Liou"
InitializeSolution "AuthorID" "b03902028"
